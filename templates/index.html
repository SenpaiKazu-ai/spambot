<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SPAM SHARE TOOL</title>
    <style>
      :root {
        --bg-gradient: #ffffff;
        --text: #1a1a2e;
        --text-dark: #1a1a2e;
        --accent: #667eea;
        --accent-secondary: #764ba2;
        --input-bg: #f5f5f5;
        --border: #e0e0e0;
        --glass-bg: #ffffff;
      }
      
      * { box-sizing: border-box; }
      
      body {
        font-family: 'Segoe UI', 'Trebuchet MS', sans-serif;
        background: var(--bg-gradient);
        color: var(--text);
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        position: relative;
        overflow-x: hidden;
      }

      body::before {
        display: none;
      }

      .container {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: calc(100vh - 40px);
        position: relative;
        z-index: 1;
      }

      .panel {
        background: var(--glass-bg);
        backdrop-filter: none;
        -webkit-backdrop-filter: none;
        padding: 50px;
        border-radius: 20px;
        border: 1px solid var(--border);
        width: 100%;
        max-width: 520px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        animation: slideUp 0.6s ease-out;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      h2 {
        margin: 0 0 10px 0;
        font-size: 32px;
        font-weight: 700;
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-secondary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: -0.5px;
      }

      .logo-container {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }

      .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-secondary) 100%);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
      }

      .heading-text {
        display: flex;
        flex-direction: column;
      }

      .heading-text h2 {
        margin: 0;
        font-size: 28px;
      }

      .heading-text .tagline {
        font-size: 11px;
        color: var(--accent);
        text-transform: uppercase;
        letter-spacing: 1px;
        font-weight: 600;
      }

      .subtitle {
        font-size: 13px;
        color: #666;
        margin-bottom: 24px;
      }

      label {
        display: block;
        text-align: left;
        margin-top: 18px;
        margin-bottom: 8px;
        font-weight: 600;
        font-size: 13px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #1a1a2e;
      }

      input, textarea {
        width: 100%;
        padding: 14px 16px;
        margin-bottom: 4px;
        border-radius: 10px;
        border: 1px solid var(--border);
        background: var(--input-bg);
        color: var(--text);
        font-size: 14px;
        outline: none;
        font-family: inherit;
        transition: all 0.3s ease;
      }

      input:focus, textarea:focus {
        border-color: var(--accent);
        background: #ffffff;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        transform: translateY(-2px);
      }

      button {
        width: 100%;
        padding: 14px 16px;
        border: none;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--accent) 0%, var(--accent-secondary) 100%);
        color: #ffffff;
        font-weight: 700;
        font-size: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 12px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        position: relative;
        overflow: hidden;
      }

      button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        transition: left 0.5s;
      }

      button:hover:not(:disabled)::before {
        left: 100%;
      }

      button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 212, 255, 0.4);
      }

      button:active:not(:disabled) {
        transform: translateY(0);
      }

      button:disabled { 
        opacity: 0.5; 
        cursor: not-allowed;
      }

      #result { 
        margin-top: 18px; 
        font-weight: 600; 
        min-height: 24px; 
        padding: 14px 16px;
        border-radius: 10px;
        background: #f5f5f5;
        border: 1px solid var(--border);
        backdrop-filter: none;
        font-size: 13px;
        line-height: 1.5;
      }

      .success { 
        color: #00b894; 
        background: rgba(0, 184, 148, 0.1);
        border-color: rgba(0, 184, 148, 0.3);
        box-shadow: 0 0 20px rgba(0, 184, 148, 0.1);
      }

      .error { 
        color: #d63031; 
        background: rgba(214, 48, 49, 0.1);
        border-color: rgba(214, 48, 49, 0.3);
        box-shadow: 0 0 20px rgba(214, 48, 49, 0.1);
      }

      .info { 
        color: var(--accent); 
        background: rgba(102, 126, 234, 0.1);
        border-color: rgba(102, 126, 234, 0.3);
        box-shadow: 0 0 20px rgba(102, 126, 234, 0.1);
      }

      footer { 
        margin-top: 32px; 
        font-size: 11px; 
        color: #999; 
        text-align: center;
        position: relative;
        z-index: 1;
      }

      @media (max-width:480px) {
        .panel { 
          padding: 28px; 
          max-width: 95%;
        }
        h2 { font-size: 24px; }
        button, input, textarea {
          font-size: 16px;
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div class="panel">
        <div class="logo-container">
          <div class="heading-text">
            <h2>Facebook Share Tool</h2>
          </div>
        </div>
        
        <label for="linkToPost">Post Link *</label>
        <input type="text" id="linkToPost" placeholder="https://www.facebook.com/..." />
        
        <label for="shareCount">Number of Shares *</label>
        <input type="number" id="shareCount" min="1" value="1" />
        
        <label for="cookieInput">Facebook Cookie *</label>
        <textarea id="cookieInput" rows="5" placeholder="Paste your Facebook cookie here..."></textarea>
        
        <button id="shareBtn" onclick="convertAndShare()">⚡ Share Now</button>
        
        <div id="result"></div>
      </div>
    </div>

    <footer>⚠️ This tool is for educational purposes only. Use responsibly.</footer>

    <script>
      async function convertAndShare() {
        const link = document.getElementById('linkToPost').value.trim();
        const count = parseInt(document.getElementById('shareCount').value) || 1;
        const cookie = document.getElementById('cookieInput').value.trim();
        const result = document.getElementById('result');

        if (!link) {
          result.className = 'error';
          result.textContent = "Please enter a post link";
          return;
        }

        if (!cookie) {
          result.className = 'error';
          result.textContent = "Please enter a Facebook cookie";
          return;
        }

        const shareBtn = document.getElementById('shareBtn');
        shareBtn.disabled = true;
        result.className = 'info';
        result.textContent = "Converting cookie to tokens...";

        try {
          // First, convert cookie to tokens
          const convertResponse = await fetch('/convert-cookie', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ cookie })
          });

          if (!convertResponse.ok) {
            const errorText = await convertResponse.text();
            console.error('Conversion error:', convertResponse.status, errorText);
            result.className = 'error';
            result.textContent = `Conversion failed (${convertResponse.status}): ${errorText || 'Server error'}`;
            return;
          }

          let convertData;
          try {
            const responseText = await convertResponse.text();
            console.log('Conversion response:', responseText);
            if (!responseText) {
              throw new Error('Empty response');
            }
            convertData = JSON.parse(responseText);
          } catch (parseErr) {
            console.error('Parse error:', parseErr);
            result.className = 'error';
            result.textContent = "Invalid server response during conversion";
            return;
          }

          const tokens = convertData.tokens;
          if (!tokens || !tokens.length) {
            result.className = 'error';
            result.textContent = "No tokens generated from cookie";
            return;
          }

          result.className = 'info';
          result.textContent = `Cookie converted! ${tokens.length} token(s) found. Starting share process...`;

          // Now share with converted tokens
          const shareResponse = await fetch('/api/share', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              link,
              accessToken: tokens,
              count
            })
          });

          if (!shareResponse.ok) {
            const errorText = await shareResponse.text();
            result.className = 'error';
            result.textContent = `Sharing failed: ${errorText || 'Server error'}`;
            return;
          }

          let shareData;
          try {
            shareData = await shareResponse.json();
          } catch (parseErr) {
            result.className = 'error';
            result.textContent = "Invalid server response during sharing";
            return;
          }

          const summary = shareData.summary;
          result.className = 'success';
          result.textContent = `✓ Complete: ${summary.successful_shares} successful, ${summary.failed_shares} failed out of ${summary.total_attempts} attempts`;
        } catch (err) {
          result.className = 'error';
          result.textContent = `Error: ${err.message}`;
        } finally {
          shareBtn.disabled = false;
        }
      }
    </script>
  </body>
</html>






